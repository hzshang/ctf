pwnable.tw writeup
==================

## start  
æ§åˆ¶è·³è½¬ï¼Œç¬¬ä¸€æ¬¡æ³„éœ²æ ˆåœ°å€ï¼Œç¬¬äºŒæ¬¡è·³è½¬åˆ°shellcode

## orw
ä½¿ç”¨æ±‡ç¼–è¾“å‡ºflag**æˆ–è€…**  
ä½¿ç”¨retfæŒ‡ä»¤ï¼Œå°†cså¯„å­˜å™¨è®¾ä¸º3ï¼Œå¯å°†æŒ‡ä»¤é›†è½¬ä¸º64ä½æ¨¡å¼ï¼Œ32ä½çš„ç³»ç»Ÿè°ƒç”¨æ— æ•ˆ
>retf æŒ‡ä»¤ä»æ ˆé¡¶å–å‡ºä¸¤ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªä¼ ç»™pcå¯„å­˜å™¨ï¼Œç¬¬äºŒä¸ªä¼ ç»™cså¯„å­˜å™¨  
>cså¯„å­˜å™¨ä¸º2è¡¨ç¤º32ä½æ¨¡å¼ ä¸º3è¡¨ç¤º64ä½æ¨¡å¼

## double sort  
- æ³„éœ²å †åœ°å€
- scanf é‡åˆ°"+"å­—ç¬¦æ—¶ï¼Œä¸ä¼šä¿®æ”¹æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜å€¼ï¼Œåˆ©ç”¨è¿™ä¸€ç‚¹ç»•è¿‡æ ˆæ£€æŸ¥

## calc
- ææ¸…æ¥šè®¡ç®—è¡¨è¾¾å¼çš„é€»è¾‘
- æ„é€ ropé“¾
- æƒ³åŠæ³•ç»•è¿‡æ ˆæ£€æŸ¥

## hacknote
ç”³è¯·unsort bin æ³„æ¼å‡ºmain_aranaåœ°å€ï¼Œæ ¹æ®ä¾¿å®œè®¡ç®—å‡ºlibcåœ°å€ï¼Œå°†è¾“å‡ºå‡½æ•°çš„æŒ‡é’ˆæ”¹ä¸ºsystemå‡½æ•°åœ°å€ï¼Œè°ƒç”¨shellã€‚

## silver bullet
- power_upå‡½æ•°æœ‰bugï¼Œå½“å¡«å……48ä¸ªå­—èŠ‚åï¼Œä¼šå°†powerçš„å€¼è¦†ç›–ä¸º0ï¼Œæ­¤æ¼æ´å¯ä»¥é€ æˆoverflow
- æ§åˆ¶è¿”å›å€¼ï¼Œå…ˆæ³„éœ²libcåœ°å€
- å†è·³è½¬åˆ°mainå‡½æ•°ï¼Œè·³è½¬åˆ°libcçš„one_gadget

## apple store
checkoutæ—¶ä¼šæœ‰ä¸€ä¸ªå½©è›‹ï¼Œå½“æ€»é¢è¾¾åˆ°7174æ—¶ä¼šå°†iphone8çš„è®¢å•åŠ å…¥è´­ç‰©è½¦ï¼Œè®¢å•æ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œ 

	struct unit{
		char* name;
		int price;
		unit* next;
		unit* back;
	};

ä½†æ˜¯æœ€åå½©è›‹è®¢å•çš„å†…å­˜å®åœ¨æ ˆä¸Šçš„ï¼ï¼åˆ©ç”¨è¿™ä¸ªbugï¼Œé€šè¿‡myreadå‡½æ•°å¯ä»¥ä¿®æ”¹æœ€åä¸€ä¸ªè®¢å•çš„ä¿¡æ¯ï¼Œè¿›è€Œå¯ä»¥æ³„éœ²å‡ºæ ˆåœ°å€å’Œlibcåœ°å€ã€‚  
æœ¬æ¥æ˜¯æƒ³å°†atoiçš„gotè¡¨ä¿®æ”¹ä¸ºsystemåœ°å€ï¼Œä½†systemçš„åœ°å€å¤„ä¸å¯å†™ã€‚  
æœ€åå‚è€ƒç½‘ä¸Šçš„æ–¹æ³•ï¼Œä¿®æ”¹mainå‡½æ•°çš„ebpå€¼ï¼Œé€šè¿‡æ¢æ ˆçš„æ–¹å¼å°†mainå‡½æ•°çš„è¿”å›åœ°å€æ”¹ä¸ºsystemåœ°å€ã€‚

## seethefile
[writeup](seethefile/README.md)  

## babystack
é€šè¿‡çˆ†ç ´çš„æ–¹æ³•è§£å‡º16ä½éšæœºæ•°ï¼Œé€šè¿‡`magic_copy`,å¯ä»¥å°†libcçš„åœ°å€å¤åˆ¶åˆ°æ ˆä¸Šï¼Œç»§ç»­çˆ†ç ´å‡ºlibcçš„åœ°å€ã€‚æœ€åå°†mainå‡½æ•°è¿”å›åœ°å€æ”¹ä¸º`one_gadget`åœ°å€ï¼Œæ‹¿åˆ°shellã€‚ï¼ˆè¿œç¨‹è¿æ¥æ¯”è¾ƒè€—æ—¶ï¼Œæœ€å¥½ç”¨å°æ—¥æœ¬ä¸»æœºã€‚ã€‚ã€‚

## death note
ç¨‹åºçš„æ¼æ´å¾ˆæ˜æ˜¾ï¼Œé¢˜ç›®ä¹Ÿç»™å‡ºäº†æç¤ºï¼Œè¦æ±‚å†™å…¥shellcode  
åœ¨add_noteæ—¶,ç”±äºindexçš„æœ€å°å€¼æ²¡æœ‰é™åˆ¶ï¼Œå› æ­¤å°†indexå†™ä¸ºè´Ÿå€¼ï¼Œå°±å¯ä»¥ä¿®æ”¹atoiçš„gotè¡¨ï¼Œè¿›ä¸€æ­¥è·³åˆ°å †ä¸Šæ‰§è¡Œæˆ‘ä»¬è¾“å…¥çš„å†…å®¹ã€‚  
è¾“å…¥å†…å®¹å¿…é¡»æ—¶å¯å†™å­—ç¬¦ï¼Œä¸€èˆ¬ç”¨åˆ°çš„`call` `ret` `jmp` éƒ½æ— æ³•è¯»å…¥ï¼Œä½†æ­¤æ—¶å †ç»“å°¾å¤„æœ‰4å­—èŠ‚çš„æ•°å€¼è¡¨ç¤ºå †çš„å‰©ä½™ç©ºé—´ï¼Œæ§åˆ¶å †å¤§å°ï¼Œä½¿æ•°å€¼é‡Œå‡ºç° `c3` å­—ç¬¦ï¼Œå¯¹åº”æ±‡ç¼–ä½retæŒ‡ä»¤ã€‚ç„¶åé€šè¿‡ `jle` ç›¸å¯¹åç§»è·³è½¬ï¼Œæ‰§è¡Œè¯¥æŒ‡ä»¤ï¼Œè·³åˆ°æ ˆä¸Šæ‰§è¡Œä»£ç ã€‚  
æ ˆä¸Šçš„å†…å®¹è‡ªå·±å¯æ§ï¼Œç›´æ¥æ„é€ shellcodeå³å¯ã€‚  

## starbound
ç¨‹åºåœ¨è¾“å…¥é€‰é¡¹æ—¶æ²¡æœ‰å¯¹åºå·èŒƒå›´åšæ£€æŸ¥ï¼Œå½“è¾“å…¥å€¼ä¸ºè´Ÿæ•°æ—¶ï¼Œç¨‹åºå¹¶ä¸åšæ£€æµ‹ã€‚å¹¶ä¸”æ¯ä¸ªåºå·å¯¹åº”çš„æ‰§è¡Œå‡½æ•°è¡¨åœ¨bssæ®µï¼Œå‡½æ•°è¡¨ä¸Šé¢å°±æ˜¯nameçš„å†…å­˜ä½ç½®ã€‚  
åˆ©ç”¨ä¸Šé¢çš„æ¼æ´ï¼Œä¿®æ”¹nameï¼Œæ§åˆ¶å¥½åºå·å¤§å°ï¼Œå°±å¯ä»¥è·³åˆ°æƒ³è¦çš„ä½ç½®ï¼Œå¯¹libcåœ°å€è¿›è¡Œæ³„éœ²ã€‚ä½†æ˜¯é¢˜ç›®å¹¶æ²¡æœ‰ç»™å‡ºlibcç‰ˆæœ¬ï¼Œä½¿ç”¨LibcSearcheræ‰¾å‡ºlibcç‰ˆæœ¬ã€‚å°†`one_gadget`çš„åœ°å€å†™å…¥åºå·å‡½æ•°è¡¨ï¼Œæ‰§è¡Œ`one_gadget`æ‹¿åˆ°shellã€‚  

## Spirited Away
- æ³„éœ²æ ˆåœ°å€ï¼Œlibcåœ°å€ã€‚
- å¾ªç¯100æ¬¡ï¼Œåˆ©ç”¨sprintfå°†`comment_size`è¦†ç›–ä¸ºä¸€ä¸ªæ›´å¤§çš„å€¼ã€‚
- è¿™æ—¶è¯»å…¥commentæ—¶è¦†ç›–nameçš„æŒ‡é’ˆä¸ºæ ˆæŒ‡é’ˆã€‚
- ä¸‹æ¬¡mallocæ—¶å¾—åˆ°çš„å†…å­˜å°±æ˜¯æ ˆç©ºé—´ã€‚
- è¯»å…¥nameæ—¶è¦†ç›–surveyè¿”å›å€¼ä¸º`one_gadget`ã€‚

## secret garden
ç”³è¯·å †å—çš„å¤§å°æ˜¯è‡ªå·±å®šä¹‰çš„ï¼Œåˆ©ç”¨è¿™ä¸€ç‚¹ç”³è¯·`unsortbin`ï¼Œå¯ä»¥æ³„éœ²å‡º`main_arena`åœ°å€ï¼Œæ ¹æ®åç§»è®¡ç®—libcåœ°å€ã€‚  
åœ¨é™¤èŠ±æ˜¯ä¸åšæ£€æŸ¥ï¼Œé€šè¿‡double freeå¯ä»¥å¯¹ä»»æ„åœ°å€è¿›è¡Œå†™æ“ä½œï¼Œè¿™é‡Œä¿®æ”¹`malloc_hook`å€¼ä¸º`one_gadget`å€¼ã€‚  
æ­¤æ—¶å¦‚æœç›´æ¥è¿›è¡Œç”³è¯·å †å—ï¼Œæ‰€æœ‰çš„`one_gadget`éƒ½æ— æ³•æ»¡è¶³æ¡ä»¶ï¼Œåå¤å°è¯•ä»¥åï¼Œå¦‚æœè®©double free è§¦å‘ç³»ç»Ÿé”™è¯¯ï¼Œä¼šè°ƒç”¨mallocå‡½æ•°ï¼Œæ­¤æ—¶å³å¯æ‰§è¡Œshellã€‚  
`one_gadget`å€¼æŒ‘é€‰æ¯”è¾ƒå‘ï¼Œæœ¬åœ°èƒ½è¿‡ä½†è¿œç¨‹ä¸€ç›´ä¸Šä¸å»ï¼Œä¸€åº¦æ€€ç–‘è‡ªå·±æ€è·¯æœ‰é—®é¢˜ã€‚å¥½ä¸å®¹æ˜“æ‰¾åˆ°äº†ä¸€ä»½åˆ«äººçš„writeupï¼Œå‘ç°åªæœ‰`one_gadget`çš„å€¼å’Œåˆ«äººä¸ä¸€æ ·ã€‚

## alive note
åšæ³•å’Œdeath noteç±»ä¼¼ï¼Œè¿™é‡Œä¿®æ”¹çš„æ˜¯atoiçš„gotè¡¨ï¼Œä¸è¿‡ç”³è¯·å †å—è¦1200æ¬¡å·¦å³ï¼Œè¿æ¥æ—¶é—´ä¸º60ç§’ï¼Œæ„å‘³ç€å’Œä¸»æœºçš„å»¶è¿Ÿä¸é«˜äº0.5msï¼ï¼ï¼ğŸŒšåæ­£æˆ‘è¿‡äº†=ï¼Œ=  


## critical_heap
ä¸€ä¸ªæ¯”è¾ƒæ˜æ˜¾çš„æ´æ˜¯åœ¨ `play_with_normal`å‡½æ•°é‡Œï¼Œæœ‰è¿™æ ·ä¸€å¥ã€‚contentæ˜¯å¯æ§çš„ï¼Œä½†æ˜¯`__printf_chunk`ç›¸æ¯”äºprintfå¤šäº†æ›´å¤šçš„æ£€æŸ¥ï¼Œç¦æ­¢ä½¿ç”¨`%N$`çš„å­—ç¬¦ä¸²ï¼Œè¿™æ ·å°±æ²¡æœ‰åŠæ³•åšåˆ°ä»»æ„åœ°å€å†™äº†ï¼Œä½†æ˜¯å› ä¸º`__printf_chunk`çš„å‚æ•°æ ˆå’Œæˆ‘ä»¬è¾“å…¥çš„bufç¦»å¾—æ¯”è¾ƒè¿‘ï¼Œæ‰€ä»¥å¯ä»¥å®ç°ä»»æ„åœ°å€è¯»ã€‚åŒæ—¶libcå’Œå †åœ°å€ä¹Ÿå¾ˆå®¹æ˜“é€šè¿‡ç”³è¯·ä¸€ä¸ªå †å—æ¥leakå‡ºæ¥ã€‚  

    if ( opt == 1 )
    {
      printf("Content :");
      _printf_chk(1LL, a1->content);
    }

æ¥ä¸‹æ¥è¦åšçš„å°±æ˜¯æŠŠflagçš„å†…å®¹è¯»å‡ºæ¥äº†ï¼Œåœ¨è°ƒç”¨localtimeçš„å‡½æ•°é‡Œï¼Œ(è¿™ä¸ªåˆ©ç”¨ç¡®å®å¤Ÿéªšï¼Œä»¥å‰éƒ½æ²¡è§è¿‡)ï¼Œä¼šè°ƒç”¨`tzset_internal`ï¼Œéƒ¨åˆ†æºä»£ç å¦‚ä¸‹

	/* Examine the TZ environment variable.  */
	tz = getenv ("TZ");
	if (tz && *tz == '\0')
	  /* User specified the empty string; use UTC explicitly.  */
	  tz = "Universal";
	/* A leading colon means "implementation defined syntax".
	   We ignore the colon and always use the same algorithm:
	   try a data file, and if none exists parse the 1003.1 syntax.  */
	if (tz && *tz == ':')
	  ++tz;
	/* Check whether the value changed since the last run.  */
	if (old_tz != NULL && tz != NULL && strcmp (tz, old_tz) == 0)
	  /* No change, simply return.  */
	  return;
	if (tz == NULL)
	  /* No user specification; use the site-wide default.  */
	  tz = TZDEFAULT;
	tz_rules[0].name = NULL;
	tz_rules[1].name = NULL;
	/* Save the value of `tz'.  */
	free (old_tz);
	old_tz = tz ? __strdup (tz) : NULL;
	/* Try to read a data file.  */
	__tzfile_read (tz, 0, NULL);
	if (__use_tzfile)
	  return

åˆ©ç”¨system_heapæŠŠTZç¯å¢ƒå˜é‡è®¾ä¸ºflagçš„è·¯å¾„ï¼Œå°±å¯ä»¥ç›´æ¥æŠŠflagè¯»åˆ°å †ä¸Šé¢ã€‚  


## bookwriter
- leak libc
- leak heap address
- change top chunk size to trigger free
- expand unsortbin size to control its content
- fake unsortbin bk to change dl open hook to heap address
- trigger error


## ä»¥ä¸‹é¢˜ç›®ä¸å…¬å¼€writeup

- kidding
- secret-of-my-heart
- de-aslr
- unexpolitable
- critical-heap++  
